# 第二章上机作业实习报告

吴家行 
2020213991

## 1 P64第2题

### 1.1 理论分析

这道题主要考察了列主元高斯消去法的步骤，以及条件数的含义。

列主元消去法相对于naive的高斯消去法来说，在每一步中将最大的主元选出，添加了换行的操作，尽可能减小“小数”做除数的概率，得到更精确的近似解。

条件数是相对误差的表现形式，如果在线性方程组中，系数矩阵的条件数是个大数时，右端项和系数矩阵的微小变化会让解向量产生较大的误差。

### 1.2 算法描述

（1） 将系数矩阵和右端项合并为增广矩阵
（2） 每一步中选取绝对值最大的主元，如果主元不在最前面，则进行换行操作，将主元换到最前面，再进行消去
（3） 最后得到一个上三角矩阵，进行回代求解，获得解向量

### 1.3 计算程序

主程序：code/main_p64_2.m

列主元高斯消去法的实现
```matlab
function ColumnGussianElimination(A,b)
% GussianColumnElimination 列主元高斯消去法的实现
% A：系数矩阵
% b：右端项
% x：解向量

% 输出A, b, detA
disp('A=');
disp(A);
disp('b=');
disp(b);
disp('detA=');
disp(det(A));

% 扩展系数矩阵成为增广矩阵
Ab=[A,b];

% n代表未知数的个数
[~, n]=size(A);
x=zeros(n,1);

% 列主元高斯消去
for i=1:n-1
    % 选主元
    max_num=abs(Ab(i,i));
    max_row=i;
    for j=i+1:n
        if abs(Ab(j,i))>max_num
            max_num=abs(Ab(j,i));
            max_row=j;
        end
    end
    
    % 判断是否需要换行
    if max_row~=i
        % 交换两行，利用初等行变换的性质
        E=eye(n);
        E([i,max_row],:)=E([max_row,i],:);
        Ab=E*Ab;
    end
    
    % 消元
    for j=i+1:n
        l=Ab(j,i)/Ab(i,i);
        Ab(j,i)=0;
        for k=i+1:n+1
            Ab(j,k)=-l*Ab(i,k)+Ab(j,k);
        end
    end
end

% 回代
for i=n:-1:1
    sum=0;
    for j=i:n
        sum=sum+x(j,1)*Ab(i,j);
    end
    x(i,1)=(Ab(i,n+1)-sum)/Ab(i,i);
end

% 输出解向量
disp("x=");
disp(x);

end
```

求解条件数
```matlab
disp("cond 1 A=");
disp(cond(A,1));
disp("cond 2 A=");
disp(cond(A,2));
disp("cond inf  A=");
disp(cond(A,inf));
```
### 1.4 计算结果分析

第(1)问中，
```matlab
A=
    3.0100    6.0300    1.9900
    1.2700    4.1600   -1.2300
    0.9870   -4.8100    9.3400

b=
     1
     1
     1

detA=
   -0.0305

x=
   1.0e+03 *

    1.5926
   -0.6319
   -0.4936
```

第(2)问中，
```matlab
A=
    3.0000    6.0300    1.9900
    1.2700    4.1600   -1.2300
    0.9900   -4.8100    9.3400

b=
     1
     1
     1

detA=
   -0.4070

x=
  119.5273
  -47.1426
  -36.8403
```

可以看出，(1)和(2)的系数矩阵中仅有两个元素有微小的差别(3.01->3.00和0.987->0.990)，然而，对应的解向量$x$相差大，再看(1)中$A$的条件数，
```matlab
cond 1 A=
   5.5228e+04

cond 2 A=
   3.0697e+04

cond inf  A=
   5.6751e+04
```

显然，$A$的条件数都是个大数，条件数一定程度上体现了解向量对于误差的敏感性，尽管$A$的变化很微小，但仍然会引起解向量$x$的较大误差。

## 2 P65第5题

### 1.1 理论分析

### 1.2 算法描述
### 1.3 计算程序
### 1.4 计算结果分析