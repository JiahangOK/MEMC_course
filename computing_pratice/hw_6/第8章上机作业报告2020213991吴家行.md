# 第8章上机作业

吴家行 2020213991

## P275 第2题

### 1 理论分析与算法

该题主要考察复合求积和Guass型求积公式的相关内容。

- 复合求积

  将积分区间$[a,b]$分为n等份，$x_k=a+kh,h=\frac{b-a}{n},k=0,1,...,n$,在每个子区间$[x_{k-1},x_k],(k=1,2,...,n)$上则有
  $$
  \int_{a}^{b} f(x)dx = \sum_{k=1}^n \int_{x_{k-1}}^{x_k} f(x)dx
  $$

- Gauss-Legendre求积公式

  设区间$[a,b]=[-1,1]$，在$[-1,1]$上的权函数$\rho(x) \equiv 1$, 相应的正交多项式为Legendre多项式$P_n(x)$

  设$f \in C[-1,1]$,那么Gauss-Legendre求积公式为
  $$
  \int_{-1}^{1} f(x)dx \approx \sum_{k=0}^n A_kf(x_k)
  $$
  其中Gauss点$x_0,x_1,...,x_n$为n+1次Legendre多项式的零点。


### 2 程序代码

该题的代码在`code/main_1.m`中，其中`GaussLegendreN4.m`是计算n=4的Gauss-Legendre求积公式结果的函数文件。

### 3 运行结果分析

运行结果：

```
[1.0,1.2]Gauss-Legendre求积结果：3.7786749568577909
[1.2,1.4]Gauss-Legendre求积结果：11.1389016929895757
[1.4,1.6]Gauss-Legendre求积结果：3.4676328828820386
[1.6,1.8]Gauss-Legendre求积结果：-2.5269646392913376
[1.8,2.0]Gauss-Legendre求积结果：-4.6309076887128349
[2.0,2.2]Gauss-Legendre求积结果：-4.4982237008915433
[2.2,2.4]Gauss-Legendre求积结果：-3.5287544079868081
[2.4,2.6]Gauss-Legendre求积结果：-2.4286021511869600
[2.6,2.8]Gauss-Legendre求积结果：-1.4713829801694287
[2.8,3.0]Gauss-Legendre求积结果：-0.7263986621394237
Gauss-Legendre复合求积结果: -1.4260246976489310
```

Gauss-Legendre复合求积结果为-1.4260246976489310，精确值为：-1.4260247563462665，绝对误差为$|-1.4260246976489310-(-1.4260247563462665)|=5.8697\times10^{-8}$。

## P275 第3题

### 1 理论分析与算法

该题主要考察Romberg求积公式的相关内容。

Romberg求积中，h取$\frac{1}{2^j}(b-a),j=0,1,...,$因此可以用j表明h的大小，令
$$
T(j,0) = T(\frac{b-a}{2^j}) \\
T(j,1) = \frac{4^1 \times T(j,0) -T(j-1,0)}{4^1-1}, j \ge 1,  \\
T(j,2) = \frac{4^2 \times T(j,1) -T(j-1,1)}{4^2-1}, j \ge 2, \\
T(j,k) = \frac{4^k \times T(j,k-1) -T(j-1,k-1)}{4^k-1}, j \ge k
$$
具体算法过程：

（1）$h=b-a,T(0,0)=\frac{h}{2}[f(a)+f(b)]$

（2）将区间[a,b]分一半，$T(1,0)=T(\frac{b-a}{2}),$
$$
T(1,1) = \frac{4^1 \times T(1,0) -T(0,0)}{4^1-1}
$$
（3）将区间分为$2^j$等份， $T(j,0)=T(\frac{b-a}{2^j}),$
$$
T(j,k) = \frac{4^k \times T(j,k-1) -T(j-1,k-1)}{4^k-1}, k=1,2,...,j,
$$
（4）$|T(j,j)-T(j-1,j-1) < \epsilon|$,$T(j,j)$即为所求。

### 2 程序代码

该题的代码在`code/main_2.m`中，其中`Tf.m`是计算复合梯形公式的函数文件。

### 3 运行结果分析

运行结果：

```
j=7, T(j,j)=-1.4260247677298050
T表：
T(0,0)=-56.5195329,
T(1,0)=-52.2328733,T(1,1)=-50.8039868,
T(2,0)=-23.8563848,T(2,1)=-14.3975553,T(2,2)=-11.9704599,
T(3,0)=-6.8278008,T(3,1)=-1.1516061,T(3,2)=-0.2685429,T(3,3)=-0.0827981,
T(4,0)=-2.6815305,T(4,1)=-1.2994404,T(4,2)=-1.3092961,T(4,3)=-1.3258159,T(4,4)=-1.3306905,
T(5,0)=-1.7326558,T(5,1)=-1.4163643,T(5,2)=-1.4241592,T(5,3)=-1.4259824,T(5,4)=-1.4263752,T(5,5)=-1.4264688,
T(6,0)=-1.5022177,T(6,1)=-1.4254049,T(6,2)=-1.4260076,T(6,3)=-1.4260370,T(6,4)=-1.4260372,T(6,5)=-1.4260369,T(6,6)=-1.4260367,
T(7,0)=-1.4450438,T(7,1)=-1.4259858,T(7,2)=-1.4260246,T(7,3)=-1.4260248,T(7,4)=-1.4260248,T(7,5)=-1.4260248,T(7,6)=-1.4260248,T(7,7)=-1.4260248,
```

Romberg求积结果为-1.4260247677298050，精确值为：-1.4260247563462665，绝对误差为$|-1.4260247677298050-(-1.4260247563462665)|=1.1384\times10^{-8}$。

